
### 游戏场景：战斗系统

假设我们正在制作一个回合制策略游戏，在这个游戏中，玩家控制一组单位与敌人战斗。

#### 练习要求

1. **定义单位特性** (`UnitTrait`)：
    - 所有单位都应该有 `name`、`health`（健康值）、`attack`（攻击力）和 `defense`（防御力）属性。
    - 所有单位都能进行 `attack` 和 `defend` 行为。

2. **定义不同类型的单位**：
    - 创建几种不同的单位结构体，比如 `Soldier`、`Archer` 和 `Cavalry`。
    - 实现 `UnitTrait` 为每种单位提供具体的行为。

3. **特殊能力**：
    - 定义一个 `SpecialAbility` trait，它有一个 `activate` 方法。
    - 为某些单位实现 `SpecialAbility` trait，比如 `Archer` 可以有 `PiercingArrow`（穿透箭），这个特殊能力可以忽视一部分防御力进行攻击。

4. **战斗模拟**：
    - 创建一个 `Battlefield` 结构体，它包含两个单位队列：玩家的单位和敌人的单位。
    - 实现 `Battlefield` 上的方法 `simulate_battle`，这个方法将模拟战斗直到一方的所有单位都被消灭。

5. **泛型和约束**：
    - 使 `Battlefield` 泛型化，以便它可以接受任何实现了 `UnitTrait` 的单位类型。
    - 确保 `simulate_battle` 方法可以调用单位的 `attack`、`defend` 和 `SpecialAbility`（如果有的话）。

#### 高级练习

- **状态模式**：
    - 为单位定义状态，比如 `Normal`、`Stunned` 或 `Poisoned`。
    - 状态影响单位的行为，例如 `Stunned` 单位在下一个回合不能行动。

- **事件系统**：
    - 实现一个事件系统，允许单位在受到攻击或其他重要事件发生时触发特定的行为。
    - 例如，当 `Soldier` 的生命值低于一定阈值时，他们可以激活 `LastStand` 能力，增加防御力。

- **组合模式**：
    - 允许单位组合成更大的单位，比如 `Phalanx`，它是由多个 `Soldier` 组成的。
    - 组合单位可以有特殊的行为和属性，比如更高的防御力。

这个练习将帮助你理解 Rust 中 trait 的使用，以及如何在游戏编程中应用它们。你可以通过增加更多复杂的逻辑和特性来扩展这个练习，例如添加单位升级、战斗地形效果或是支持多种战斗模式等。
